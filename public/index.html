<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coyote Creek Scorer</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="manifest" href="manifest.json">
</head>
<body>
    <header>
        <h1>Coyote Collator</h1>
        <div id="status-indicator" class="status-offline">Offline</div>
    </header>

    <main>
        <!-- View: Home / Sync -->
        <div id="view-home">
             <div class="card">
                <h2>Welcome, Judge.</h2>

                <div style="margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid #eee;">
                    <label style="display:block; margin-bottom:0.5rem">My Info:</label>
                    <input type="text" id="judge-name" placeholder="Name (e.g. Bill Scout)" style="width:100%; margin-bottom:0.5rem; padding:8px;">
                    <input type="email" id="judge-email" placeholder="Email (Unique ID)" style="width:100%; margin-bottom:0.5rem; padding:8px;">
                    <input type="text" id="judge-unit" placeholder="Unit (e.g. Troop 101)" style="width:100%; margin-bottom:0.5rem; padding:8px;">
                </div>

                <div class="sync-status">
                    <p>Unsynced Scores: <span id="unsynced-count">0</span></p>
                    <button id="btn-sync" class="btn btn-secondary">Sync Scores Now</button>
                    <button id="btn-reload-data" class="btn btn-outline" style="margin-top:0.5rem">Reload Config & Roster</button>
                    <small id="last-updated" style="display:block; margin-top:0.5rem; color:#666;"></small>
                </div>
             </div>

             <h3>Select Station</h3>
             <div id="station-list">
                 <!-- Populated by JS -->
                 <div class="card">Loading Games...</div>
             </div>
        </div>

        <!-- View: Entity Selection -->
        <div id="view-entity" class="hidden">
            <button class="btn btn-outline" onclick="app.navigate('home')">← Back</button>
            <h2 id="entity-header">Select Team</h2>

            <input type="text" id="entity-search" placeholder="Search by number or name..." style="margin-bottom: 1rem;">

            <div id="entity-list">
                <!-- Populated by JS -->
            </div>
        </div>

        <!-- View: Scoring Form -->
        <div id="view-scoring" class="hidden">
            <button class="btn btn-outline" onclick="app.showEntitySelect()">← Change Team</button>
            <h2 id="scoring-title">Station Name</h2>
            <h3 id="scoring-team">Team Name</h3>

            <form id="score-form">
                <!-- Dynamically generated -->
            </form>

            <button id="btn-submit" class="btn btn-large btn-secondary">Submit Score</button>
        </div>

    </main>

    <script type="module" src="js/app.js"></script>
    <script>
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js')
                .then(reg => console.log('SW Registered'))
                .catch(err => console.log('SW Fail', err));
        }
    </script>
</body>
</html>
